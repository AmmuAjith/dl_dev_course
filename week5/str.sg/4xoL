<!DOCTYPE html>
<!--[if IE 8]> <html class="no-js lt-ie9 is-ie"> <![endif]-->
<!--[if IE 9]> <html class="no-js is-ie"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js"  lang="en" dir="ltr" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# book: http://ogp.me/ns/book# profile: http://ogp.me/ns/profile# video: http://ogp.me/ns/video# product: http://ogp.me/ns/product# content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema# schema: http://schema.org/"> <!--<![endif]-->
<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="/sites/all/themes/custom/bootdemo/js/ads_checker.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="image_src" href="http://www.straitstimes.com/sites/all/themes/custom/bootdemo/images/facebook_default_logo.jpg" />
<link rel="shortcut icon" href="https://static.straitstimes.com.sg/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon-60x60.png" type="image/png" />
<link rel="image_src" href="http://www.straitstimes.com/sites/default/files/media-brightcove/5156675453001.jpg" />
<meta name="description" content="SAN FRANCISCO (REUTERS) - Yahoo last year secretly built a custom software program to search all of its customers&#039; incoming e-mails for specific information provided by US intelligence officials, according to people familiar with the matter.. Read more at straitstimes.com." />
<meta name="vr:type" content="video" />
<meta property="og:image:width" content="763" />
<meta property="og:image" content="http://www.straitstimes.com/sites/default/files/media-brightcove/5156675453001.jpg" />
<meta property="og:image:height" content="509" />
<meta name="news_keywords" content="YAHOO, PRIVACY ISSUES, SURVEILLANCE" />
<link rel="canonical" href="http://www.straitstimes.com/tech/yahoo-secretly-scanned-customer-e-mails-for-us-intelligence-sources" />
<link rel="shortlink" href="http://www.straitstimes.com/node/299800" />
<meta property="fb:admins" content="100007469197550" />
<meta property="fb:app_id" content="263116810509534" />
<meta property="og:site_name" content="The Straits Times" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Yahoo secretly scanned customer e-mails for US intelligence: Sources" />
<meta property="og:url" content="http://www.straitstimes.com/tech/yahoo-secretly-scanned-customer-e-mails-for-us-intelligence-sources" />
<meta property="og:description" content="SAN FRANCISCO (REUTERS) - Yahoo last year secretly built a custom software program to search all of its customers&#039; incoming e-mails for specific information provided by US intelligence officials, according to people familiar with the matter.. Read more at straitstimes.com." />
<meta property="og:updated_time" content="2016-10-05T15:07:33+08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@STCOM" />
<meta name="twitter:title" content="Yahoo secretly scanned customer e-mails for US intelligence: Sources, Tech News &amp; Top Stories - The Straits Times" />
<meta name="twitter:url" content="http://www.straitstimes.com/tech/yahoo-secretly-scanned-customer-e-mails-for-us-intelligence-sources" />
<meta name="twitter:description" content="Tech News -SAN FRANCISCO (REUTERS) - Yahoo last year secretly built a custom software program to search all of its customers&#039; incoming e-mails for specific information provided by US intelligence officials, according to people familiar with the matter.. Read more at straitstimes.com." />
<meta property="article:published_time" content="2016-10-05T05:13:21+08:00" />
<meta property="article:modified_time" content="2016-10-05T15:07:33+08:00" />
<meta itemprop="description" content="SAN FRANCISCO (REUTERS) - Yahoo last year secretly built a custom software program to search all of its customers&#039; incoming e-mails for specific information provided by US intelligence officials, according to people familiar with the matter." />
<meta itemprop="name" content="Yahoo secretly scanned customer e-mails for US intelligence: Sources" />
<meta itemprop="image" content="http://players.brightcove.net/4539381505001/default_default/index.html?videoId=5156675453001" />
<meta name="dcterms.title" content="Yahoo secretly scanned customer e-mails for US intelligence: Sources" />
<meta name="dcterms.creator" content="hermesauto" />
<meta name="dcterms.description" content="SAN FRANCISCO (REUTERS) - Yahoo last year secretly built a custom software program to search all of its customers&#039; incoming e-mails for specific information provided by US intelligence officials, according to people familiar with the matter." />
<meta name="dcterms.date" content="2016-10-05T05:13+08:00" />
<meta name="dcterms.type" content="Text" />
<meta name="dcterms.format" content="text/html" />
<meta name="dcterms.identifier" content="http://www.straitstimes.com/tech/yahoo-secretly-scanned-customer-e-mails-for-us-intelligence-sources" />
<!-- Apple Touch Icons --><link rel="apple-touch-icon" href="/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon.png" />
<link rel="apple-touch-icon" sizes="57x57" href="/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="60x60" href="/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon-152x152.png" />
<link rel="apple-touch-icon" sizes="192x192" href="/sites/all/themes/custom/bootdemo/images/icons/apple-touch-icon-192x192.png" />
<!-- Windows8 Tile Icons --><meta name="msapplication-square70x70logo" content="/sites/all/themes/custom/bootdemo/images/icons/smalltile.png" />
<meta name="msapplication-square150x150logo" content="/sites/all/themes/custom/bootdemo/images/icons/mediumtile.png" />
<meta name="msapplication-wide310x150logo" content="/sites/all/themes/custom/bootdemo/images/icons/widetile.png" />
<meta name="msapplication-square310x310logo" content="/sites/all/themes/custom/bootdemo/images/icons/largetile.png" />
        <title>Yahoo secretly scanned customer e-mails for US intelligence: Sources, Tech News & Top Stories - The Straits Times</title>
  <link type="text/css" rel="stylesheet" href="https://static.straitstimes.com.sg/sites/default/files/css/css_pIXOTJbV_VbmzOW7MK4qwZf5kY8GGzwKoU-RnwRSJlA.css" media="all" />
  
  <!-- HTML5 element support for IE6-8 -->
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
  <!-- Defining _data variables starts -->
  <script type="text/javascript">
    window.getCookieByName = function(name) {
      match = document.cookie.match(new RegExp(name + '=([^;]+)'));
      if (match) return match[1];
    }
  </script>
    <script  type="text/javascript">
  var x13='';
  if( window.canRunAds === undefined ){
    x13 = 1;
  }else{
    x13 = 0;
  }
  var _data = {
      "level2": "7",
      "chapter1": "Tech",
      "chapter2": "",
      "chapter3": "",
      "title": encodeURIComponent("Yahoo_secretly_scanned_customer_e-mails_for_US_intelligence%3A_Sources"),
      "mc": "",
      "np": "1",
      "contenttype": "1",
      "pagination": "",
      "author": "",
      "contentcat": "3",
      "articleid": "299800",
      "articlecount": "0",
      "printcat":"",
      "keyword":"YAHOO,PRIVACY ISSUES,SURVEILLANCE",
      "adblocker": x13,
      "pubdate":"2016:10:05 05:13:21",
      "section": "",
      "adunit": "",
      "size": "",
      "ad_display": "",
      "pos": ""
      }
  </script>
<!-- Defining _data variables ends -->

  <!-- Begin Lotame ID -->
  <script defer type="text/javascript" src="http://ad.crwdcntrl.net/5/c=4334/pe=y/var=ccauds">
  </script>

  <script type="text/javascript">
  window.addEventListener('DOMContentLoaded', function() {
    var lotame_id = '';
    if (typeof(ccauds) != 'undefined') {
      //console.log(ccauds.Profile.pid);
      lotame_id = ccauds.Profile.pid;
      _data.lotameid = lotame_id;
      var lot_expiry = new Date();lot_expiry.setTime(lot_expiry.getTime() + (24*60*60*1000));
      document.cookie = "STLotameID="+lotame_id+";path=/; expires=" + lot_expiry.toGMTString();
      //googletagCmdPusher();
    }
  });
  </script>
  <!-- End Lotame ID -->
  

  <!--preview script -->
  <script type="text/javascript">
  function querystring(key) {
     var re=new RegExp('(?:\\?|&)'+key+'=(.*?)(?=&|$)','gi');
     var r=[], m;
     while ((m=re.exec(document.location.search)) != null) r[r.length]=m[1];
     return r;
  }
  var key ='dfp_preview';
  var keycode = querystring(key);
  </script>
  <!--preview script -->
        <script type="text/javascript">
          var gs_channels="no_category";
      </script>
                    <script type="text/javascript">
        gs_channels=['gs_tech_computing','gs_politics_american','gs_entertain_tv','gs_politics_misc','gs_tech_phones','gv_terrorism','gv_death_injury'];
      </script>
        
    


  <script src="http://adtag.asiaone.com/tag/st/js/prebid/prebid.js"></script>
<script src="http://adtag.asiaone.com/tag/st/js/prebid/st_prebid_min.js"></script>
<script src="http://www.googletagservices.com/tag/js/gpt.js"></script>
<script src="https://static.straitstimes.com.sg/sites/default/files/js/js_t7EZQpPA6S7UAhLZh5hTczrEdJWIlshPecIWCq68PfQ.js"></script>
<script src="https://static.straitstimes.com.sg/sites/default/files/js_injector/js_injector_12.js?oygxlo"></script>
<script>var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];var isArticlePage = false;
if (typeof _data != 'undefined' && typeof _data.articleid != 'undefined' && _data.articleid != "") {
isArticlePage = true;
}
var fluid = 'fluid';
googletag.slots = googletag.slots || {};</script>
<script>function send_adload(ad_starttime,ad_endtime,dfp_id) {
  var ad_LoadTime;
  ad_LoadTime=ad_endtime-ad_starttime;
  console.log(dfp_id + ": " + ad_LoadTime + "ms");
  if (typeof window.ga == "function") { 
    window["ga"]("ST.send", "timing", "Ad Load Time", dfp_id, ad_LoadTime);
  }
}
function getreferrer() {
  var refresponse="direct";
  var siteref="";
  if(document.referrer.split("/")[2]) {
    siteref=document.referrer.split("/")[2];
    if (/google/i.test(siteref)) {
      refresponse="google";
    }else if (/facebook/i.test(siteref)) {
      refresponse="facebook";
    }else {
      refresponse="others";
    }
  }
  return refresponse;
}
var tarref = getreferrer();
</script>
<script>var mapping = googletag.sizeMapping()
  .addSize([1024, 0], [[970, 90], [728, 90], [970, 250]])
  .addSize([740, 0], [728, 90])
  .addSize([320, 0], [[320, 50], [320, 100]])
  .addSize([0, 0], [[320, 50], [320, 100]])
  .build();
googletag.slots["lb1"] = googletag.defineSlot("/5908/st/lb1/tech", [728, 90], "dfp-ad-lb1")
  .addService(googletag.pubads())
  .setTargeting("pos", "1")
  .setTargeting("sttags", ["yahoo","privacy-issues","surveillance"])
  .setTargeting("starticleid", "299800")
  .defineSizeMapping(mapping);</script>
<script>var dfp_preview_ids = querystring("dfp_preview"); var show_overlay=0; if (document.cookie.indexOf("topoverlayDisplayed=") == -1 || (dfp_preview_ids!= undefined && dfp_preview_ids.length!=0) ) {googletag.slots["topoverlay"] = googletag.defineSlot("/5908/st/topoverlay/tech", [1, 1], "dfp-ad-topoverlay")
  .addService(googletag.pubads())
  .setTargeting("pos", "topoverlay")
  .setTargeting("sttags", ["yahoo","privacy-issues","surveillance"])
  .setTargeting("starticleid", "299800")
  .setTargeting("referrer", tarref);expiry = new Date();expiry.setTime(expiry.getTime() + (overlay_validity*60*60*1000));
                document.cookie = "topoverlayDisplayed=yes;path=/; expires=" + expiry.toGMTString(); show_overlay=1;}</script>
<script>googletag.slots["imu1"] = googletag.defineSlot("/5908/st/imu1/tech", [[1, 1], [10, 10], [300, 250], [780, 300], 'fluid'], "dfp-ad-imu1")
  .addService(googletag.pubads())
  .setTargeting("pos", "1")
  .setTargeting("sttags", ["yahoo","privacy-issues","surveillance"])
  .setTargeting("starticleid", "299800");</script>
<script>googletag.slots["imu2"] = googletag.defineSlot("/5908/st/imu2/tech", [[300, 600], [300, 250]], "dfp-ad-imu2")
  .addService(googletag.pubads())
  .setTargeting("pos", "2")
  .setTargeting("sttags", ["yahoo","privacy-issues","surveillance"])
  .setTargeting("starticleid", "299800");</script>
<script>googletag.slots["midarticlespecial"] = googletag.defineSlot("/5908/st/midarticlespecial/tech", [[1, 1], 'fluid'], "dfp-ad-midarticlespecial")
  .addService(googletag.pubads())
  .setTargeting("pos", "midarticlespecial")
  .setTargeting("sttags", ["yahoo","privacy-issues","surveillance"])
  .setTargeting("starticleid", "299800");</script>
<script>googletag.slots["bi1"] = googletag.defineSlot("/5908/st/bi1/tech", 'fluid', "dfp-ad-bi1")
  .addService(googletag.pubads())
  .setTargeting("pos", "bi1")
  .setTargeting("sttags", ["yahoo","privacy-issues","surveillance"])
  .setTargeting("starticleid", "299800");</script>
<script>googletag.slots["bi2"] = googletag.defineSlot("/5908/st/bi2/tech", 'fluid', "dfp-ad-bi2")
  .addService(googletag.pubads())
  .setTargeting("pos", "bi2")
  .setTargeting("sttags", ["yahoo","privacy-issues","surveillance"])
  .setTargeting("starticleid", "299800");</script>
<script>googletag.slots["bi3"] = googletag.defineSlot("/5908/st/bi3/tech", 'fluid', "dfp-ad-bi3")
  .addService(googletag.pubads())
  .setTargeting("pos", "bi3")
  .setTargeting("sttags", ["yahoo","privacy-issues","surveillance"])
  .setTargeting("starticleid", "299800");</script>
<script>googletag.slots["bi4"] = googletag.defineSlot("/5908/st/bi4/tech", 'fluid', "dfp-ad-bi4")
  .addService(googletag.pubads())
  .setTargeting("pos", "bi4")
  .setTargeting("sttags", ["yahoo","privacy-issues","surveillance"])
  .setTargeting("starticleid", "299800");</script>
<script>document.createElement( "picture" );</script>
<script>googletag.cmd.push(function() {
  googletag.pubads().enableAsyncRendering();
  googletag.pubads().enableSingleRequest();
  googletag.pubads().collapseEmptyDivs();
});
googletag.pubads().addEventListener('slotRenderEnded', function(event) {

//console.log(event.slot.C );

if(googletag.slots["imu1"] == event.slot && event.size[0] == 300 && event.size[1] == 250) {
document.getElementById("dfp-ad-imu1").className += " greywash";
}
});
//function googletagCmdPusher() {
var pathArray = window.location.pathname.split( '/' );
if((pathArray[1] != "newslettr") && (pathArray[2] != "regform") ){
googletag.cmd.push(function() {
  googletag.pubads().setTargeting("dfp_cc_id", window.getCookieByName("STLotameID"));
  googletag.pubads().setTargeting(key, keycode);
});
if(isArticlePage) { 
googletag.pubads().setTargeting("gs_channels", gs_channels);
}
//googletag.companionAds().setRefreshUnfilledSlots(false);
//}
}
if(isArticlePage) { 
var gsMetaTag = document.createElement("meta");
gsMetaTag.id = "grapeshot";
gsMetaTag.name = "grapeshot_tag";
gsMetaTag.content = gs_channels;
document.getElementsByTagName("head")[0].appendChild(gsMetaTag);
}
googletag.enableServices();</script>
<script>a2a_config={menu_type:"mail"};a2a_config.no_3p = 1;a2a_config.templates={twitter:"${title} http://str.sg/4xou "};a2a_config.track_links="ga";a2a_config.color_link_text = "333333";</script>
<script>
      jQuery(document).ready(function () {
        jQuery.ajax({
          dataType: "json",
          async: false,
          type: "GET",
          url: "/story/next/?nid=299800&date=20161005&tid=31",
          cache: true,
          data: { },
          success: function(data) {
            if (data.markup) {
              jQuery("#prev-next-story").html(data.markup);
              jQuery("body.node-type-article").once().append("<div class=\"floatlinks hidden-print\"></div>");
              jQuery(".floatlinks").append(data.markup);
            }
          }
        });
      })</script>
<script><!--Visual Revenue Reader Response Tracking Script (v6) -->
	var _vrq = _vrq || [];
	_vrq.push(['id', 627]);
	_vrq.push(['automate', false]);
	_vrq.push(['track', function(){}]);
	(function(d, a){
		var s = d.createElement(a),
		x = d.getElementsByTagName(a)[0];
		s.async = true;
		s.src = 'http://a.visualrevenue.com/vrs.js';
		x.parentNode.insertBefore(s, x);
	})(document, 'script');
<!-- End of VR RR Tracking Script - All rights reserved --></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"bootdemo","theme_token":"Hj02Rb0uOdqfFHDse26zfDlGWYU75Hnb0x3hbwEwR4k","js":{"sites\/all\/modules\/contrib\/picture\/picturefill2\/picturefill.js":1,"sites\/all\/modules\/contrib\/picture\/picture.js":1,"sites\/all\/themes\/contrib\/bootstrap\/js\/bootstrap.js":1,"0":1,"1":1,"2":1,"http:\/\/adtag.asiaone.com\/tag\/st\/js\/prebid\/prebid.js":1,"http:\/\/adtag.asiaone.com\/tag\/st\/js\/prebid\/st_prebid_min.js":1,"http:\/\/www.googletagservices.com\/tag\/js\/gpt.js":1,"sites\/all\/modules\/contrib\/jquery_update\/replace\/jquery\/2.2\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/contrib\/jquery_update\/replace\/ui\/ui\/minified\/jquery.ui.core.min.js":1,"sites\/all\/modules\/contrib\/jquery_update\/replace\/ui\/external\/jquery.cookie.js":1,"sites\/all\/modules\/contrib\/panopoly_theme\/js\/panopoly-accordion.js":1,"sites\/all\/modules\/contrib\/lazyloader\/jquery.lazyloader.js":1,"sites\/all\/themes\/custom\/bootdemo\/js\/ZeroClipboard.js":1,"sites\/all\/libraries\/owl-carousel\/owl.carousel.min.js":1,"sites\/all\/themes\/custom\/bootdemo\/js\/iframeResizer\/js\/iframeResizer.min.js":1,"sites\/all\/themes\/custom\/bootdemo\/js\/jquery.marquee.js":1,"sites\/all\/themes\/custom\/bootdemo\/bootstrap\/js\/affix.js":1,"sites\/all\/themes\/custom\/bootdemo\/bootstrap\/js\/alert.js":1,"sites\/all\/themes\/custom\/bootdemo\/bootstrap\/js\/collapse.js":1,"sites\/all\/themes\/custom\/bootdemo\/bootstrap\/js\/dropdown.js":1,"sites\/all\/themes\/custom\/bootdemo\/bootstrap\/js\/modal.js":1,"sites\/all\/themes\/custom\/bootdemo\/bootstrap\/js\/tooltip.js":1,"sites\/all\/themes\/custom\/bootdemo\/bootstrap\/js\/scrollspy.js":1,"sites\/all\/themes\/custom\/bootdemo\/bootstrap\/js\/tab.js":1,"sites\/all\/themes\/custom\/bootdemo\/js\/jquery.cycle.all.js":1,"sites\/all\/themes\/custom\/bootdemo\/js\/bootdemo.js":1,"https:\/\/static.straitstimes.com.sg\/sites\/default\/files\/js_injector\/js_injector_12.js":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1},"css":{"modules\/system\/system.base.css":1,"misc\/ui\/jquery.ui.core.css":1,"misc\/ui\/jquery.ui.theme.css":1,"misc\/ui\/jquery.ui.tabs.css":1,"misc\/ui\/jquery.ui.accordion.css":1,"sites\/all\/modules\/contrib\/cache_consistent\/css\/cache_consistent.css":1,"sites\/all\/themes\/custom\/bootdemo\/css\/style.css":1,"sites\/all\/libraries\/owl-carousel\/owl.carousel.css":1,"sites\/all\/libraries\/owl-carousel\/owl.theme.css":1}},"field_group":{"html5":"article_default","html-element":"image_with_captions"},"bootstrap":{"anchorsFix":1,"anchorsSmoothScrolling":1,"formHasError":1,"popoverEnabled":1,"popoverOptions":{"animation":1,"html":0,"placement":"right","selector":"","trigger":"click","triggerAutoclose":1,"title":"","content":"","delay":0,"container":"body"},"tooltipEnabled":1,"tooltipOptions":{"animation":1,"html":0,"placement":"auto left","selector":"","trigger":"hover focus","delay":0,"container":"body"}}});</script>

  <script type="text/javascript" src="//static.addtoany.com/menu/page.js" async></script>
<!-- ### JS loaded check ### -->
<!--Smart App Banner implementation -->
  <script type="text/javascript">
    if ( /(iPad).*AppleWebKit.*Mobile.*Safari/.test(navigator.userAgent) ) {
      var headNode = document.getElementsByTagName("head")[0];
      var sbNode = document.createElement('meta');
      sbNode.name = 'apple-itunes-app';
      sbNode.content = 'app-id=547459568';
      headNode.appendChild(sbNode);
    } else if ( /(iPhone|iPod).*AppleWebKit.*Mobile.*Safari/.test(navigator.userAgent) ) {
      var headNode = document.getElementsByTagName("head")[0];
      var sbNode = document.createElement('meta');
      sbNode.name = 'apple-itunes-app';
      sbNode.content = 'app-id=547465441';
      headNode.appendChild(sbNode);
    }
  </script>

     <!-- TMS script Starts -->
  <script defer src="//nexus.ensighten.com/sph/stprod/Bootstrap.js"></script>
  <!-- TMS implementation Ends -->
  <!-- Smart tag script starts -->
  <!-- <script src="//tag.aticdn.net/538291/smarttag.js"></script> -->
  <!-- Smart tag script ends -->
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-299800 node-type-article article-type-default friday context-tech context-day-friday" >
  <div id="dfp-ad-topoverlay-wrapper" class="dfp-tag-wrapper"><div  id="dfp-ad-topoverlay" class="dfp-tag-wrapper">
    
  <script type="text/javascript">
    
    if (show_overlay==1 || (dfp_preview_ids!= undefined && dfp_preview_ids.length!=0)) {
        googletag.cmd.push(function() {
      googletag.display("dfp-ad-topoverlay");
    });
        }
      </script>
  </div>
</div>  <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.async=true;
      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=263116810509534";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
        <style>div.rotator_title { font-size:18px; }</style>
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <header id="navbar" role="banner" class="navbar container navbar-default">
  <div class="container">
    <div class="navbar-header has-category-term">
      
            <h1 class="site-name"><a class="name navbar-brand" href="/" title="Home"><span>The Straits Times</span></a></h1>
             <!--add win IFRA header -->
        <!--add win IFRA header in tags pages -->
            
            <h2 class="web-category-name"><a href="/tech">Tech</a></h2>
      
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

    </div>

          <div class="navbar-collapse collapse has-category-term">
        <nav role="navigation">
                      <ul class="menu nav navbar-nav"><li class="first leaf nav-home"><a href="/">Home</a></li>
<li class="collapsed no-dropdown nav-singapore"><a href="/singapore">Singapore</a></li>
<li class="collapsed no-dropdown nav-politics"><a href="/politics">Politics</a></li>
<li class="collapsed no-dropdown nav-asia"><a href="/asia">Asia</a></li>
<li class="collapsed no-dropdown nav-world"><a href="/world">World</a></li>
<li class="collapsed no-dropdown nav-videos"><a href="/videos">Videos</a></li>
<li class="expanded no-dropdown nav-multimedia"><a href="/multimedia" class="hidden-md hidden-sm">Multimedia</a><ul class="subcat-menu" data-parent-menu="Multimedia"><li class="first leaf"><a href="/multimedia/photos">Photos</a></li>
<li class="last leaf"><a href="/multimedia/graphics">Graphics</a></li>
</ul></li>
<li class="collapsed no-dropdown nav-lifestyle"><a href="/lifestyle">Lifestyle</a></li>
<li class="leaf"><a href="/lifestyle/food">Food</a></li>
<li class="expanded no-dropdown nav-forum"><a href="/forum" class="hidden-sm">Forum</a><ul class="subcat-menu" data-parent-menu="Forum"><li class="first leaf"><a href="/forum/letters-in-print">Letters in Print</a></li>
<li class="leaf"><a href="/forum/letters-on-the-web">Letters on the Web</a></li>
<li class="last leaf"><a href="/forum/readers-post">Readers&#039; Post</a></li>
</ul></li>
<li class="expanded no-dropdown nav-opinion"><a href="/opinion" class="hidden-sm">Opinion</a><ul class="subcat-menu" data-parent-menu="Opinion"><li class="first leaf"><a href="/opinion/st-editorial">ST Editorial</a></li>
<li class="last leaf"><a href="/opinion/cartoons">Cartoons</a></li>
</ul></li>
<li class="expanded no-dropdown nav-business"><a href="/business" class="hidden-sm">Business</a><ul class="subcat-menu" data-parent-menu="Business"><li class="first leaf"><a href="/business/companies-markets">Companies &amp; Markets</a></li>
<li class="leaf"><a href="/business/economy">Economy</a></li>
<li class="leaf"><a href="/business/banking">Banking</a></li>
<li class="leaf"><a href="/business/property">Property</a></li>
<li class="leaf"><a href="/business/invest">Invest</a></li>
<li class="last leaf"><a href="/business/market">Market</a></li>
</ul></li>
<li class="expanded no-dropdown nav-sport"><a href="/sport" class="hidden-md hidden-sm">Sport</a><ul class="subcat-menu" data-parent-menu="Sport"><li class="first leaf"><a href="/sport/football">Football</a></li>
<li class="leaf"><a href="/sport/tennis">Tennis</a></li>
<li class="leaf"><a href="/sport/formula-one">Formula One</a></li>
<li class="leaf"><a href="/sport/basketball">Basketball</a></li>
<li class="leaf"><a href="/sport/golf">Golf</a></li>
<li class="last leaf"><a href="/sport/schools">Schools</a></li>
</ul></li>
<li class="expanded no-dropdown nav-tech"><a href="/tech" class="hidden-md hidden-sm">Tech</a><ul class="subcat-menu" data-parent-menu="Tech"><li class="first leaf"><a href="/tech/smartphones">Smartphones</a></li>
<li class="leaf"><a href="/tech/tablets">Tablets</a></li>
<li class="leaf"><a href="/tech/pcs">PCs</a></li>
<li class="leaf"><a href="/tech/cameras">Cameras</a></li>
<li class="leaf"><a href="/tech/audio">Audio</a></li>
<li class="leaf"><a href="/tech/wearables">Wearables</a></li>
<li class="last leaf"><a href="/tech/games-apps">Games &amp; Apps</a></li>
</ul></li>
<li class="last expanded active-trail visible-sm visible-sm-block visible-md visible-md-block active dropdown"><a href="/rss-feeds" class="active-trail dropdown-toggle" data-target="#" data-toggle="dropdown">More <span class="caret"></span></a><ul class="dropdown-menu"><li class="first leaf"><a href="/multimedia" class="more-item visible-sm visible-sm-block visible-md visible-md-block">Multimedia</a></li>
<li class="leaf"><a href="/forum" class="hidden-md more-item">Forum</a></li>
<li class="leaf"><a href="/opinion" class="hidden-md more-item">Opinion</a></li>
<li class="leaf"><a href="/business" class="hidden-md more-item">Business</a></li>
<li class="leaf"><a href="/sport" class="more-item">Sport</a></li>
<li class="last leaf active-trail active"><a href="/tech" class="more-item active-trail">Tech</a></li>
</ul></li>
</ul>                              <div class="block-sph-sites">
            <div class="navbar-sph-sites">
              <ul class="menu nav navbar-nav secondary"><li class="first last expanded dropdown"><a href="http://www.sph.com.sg/our-businesses/online/sph-digital/" class="sph-sites-toggle dropdown-toggle" target="_blank" data-target="#" data-toggle="dropdown">SPH Websites <span class="caret"></span></a><ul class="dropdown-menu"><li class="first leaf"><a class="sph-stplus nolink">news with benefits</a></li>
<li class="leaf"><a href="http://stwine.sg/" class="sph-stwine">ST Wine</a></li>
<li class="leaf"><a href="http://www.straitstimes.com/tags/st-plus-rewards" class="sph-rewards">SPH Rewards</a></li>
<li class="leaf"><a href="http://www.stjobs.sg/?utm_source=Straits+Times&amp;utm_medium=banner&amp;utm_campaign=ST_link_20131219" class="sph-jobs" target="_blank">STJobs</a></li>
<li class="leaf"><a href="http://www.stcars.sg/?utm_source=Straits+Times&amp;utm_medium=banner&amp;utm_campaign=ST_link_20131219" class="sph-cars" target="_blank">STCars</a></li>
<li class="leaf"><a href="http://www.stproperty.sg/?utm_source=Straits+Times&amp;utm_medium=banner&amp;utm_campaign=ST_link_20131219" class="sph-property" target="_blank">STProperty</a></li>
<li class="leaf"><a href="http://www.stclassifieds.sg/?utm_source=Straits+Times&amp;utm_medium=banner&amp;utm_campaign=ST_link_20131219" class="sph-classifieds" target="_blank">STClassifieds</a></li>
<li class="leaf"><a class="sph-sph nolink">SITES</a></li>
<li class="leaf"><a href="http://www.asiaone.com/" class="sph-asiaone" target="_blank">AsiaOne</a></li>
<li class="leaf"><a href="http://beritaharian.sg/" class="sph-berita" target="_blank">Berita Harian</a></li>
<li class="leaf"><a href="http://www.hardwarezone.com.sg/" class="sph-hardware" target="_blank">Hardwarezone</a></li>
<li class="leaf"><a href="http://www.wanbao.com.sg/" class="sph-wanbao" target="_blank">Lianhe Wanbao</a></li>
<li class="leaf"><a href="http://www.omy.sg/" class="sph-omy" target="_blank">omy.sg</a></li>
<li class="leaf"><a href="http://www.stomp.com.sg/" class="sph-stomp" target="_blank">STOMP</a></li>
<li class="leaf"><a href="http://www.sgcarmart.com/" class="sph-sgcar" target="_blank">SGCarMart</a></li>
<li class="leaf"><a href="http://www.shareinvestor.com/" class="sph-si" target="_blank">ShareInvestor</a></li>
<li class="leaf"><a href="http://www.srx.com.sg/" class="sph-srx" target="_blank">SRX Property</a></li>
<li class="leaf"><a href="http://www.tabla.com.sg/" class="sph-tabla" target="_blank">tabla</a></li>
<li class="leaf"><a href="http://www.tamilmurasu.com.sg/" class="sph-tamil" target="_blank">Tamil Murasu</a></li>
<li class="leaf"><a href="http://www.businesstimes.com.sg/" class="sph-bt" target="_blank">The Business Times</a></li>
<li class="leaf"><a href="http://www.tnp.sg/" class="sph-tnp" target="_blank">The New Paper</a></li>
<li class="leaf"><a href="http://www.zaobao.com" class="sph-zaobao" target="_blank">zaobao.sg</a></li>
<li class="last leaf"><a href="http://www.straitstimes.com/advertise-with-the-straits-times">Advertise with us</a></li>
</ul></li>
</ul>            </div>
          </div>
                                <div class="block-user-menu">
              <button type="button" class="navbar-toggle-user" data-toggle="dropdown" data-target=".navbar-user"></button>
              <div class="navbar-user  dropdown-menu" role="menu">

                <ul class="menu nav navbar-nav menu-user">
                                      <!--li><a href="#" class="" data-toggle="modal" data-target="#ldapAlert">Log In</a></li-->
                </ul>

              </div>
            </div>
            <div class="block-nav-search mobileonly">
              <button type="button" class="navbar-toggle-search" data-toggle="collapse" onclick="return false;"></button>
            </div>
            <div class="block-menu-paper">
              <button type="button" class="navbar-toggle-paper" data-toggle="dropdown" data-target=".navbar-paper"></button>
              <div class="navbar-paper  dropdown-menu" role="menu">
                <ul class="menu nav navbar-nav menu-paper">
                  <li class="nav-print-edition"><a href="/print-edition/">Print Edition</a></li>
                  <li class="nav-epaper"><a href="http://stepaper.straitstimes.com" target="_blank">ePaper</a></li>
                  <li class="nav-sti-index visible-xs"><a href="/business/market">ST Index</a></li>
                </ul>
              </div>
            </div>
                        <div class="block-nav-search">
              <button type="button" class="navbar-toggle-search" data-toggle="collapse" data-target=".navbar-search"></button>
            </div>

            
        </nav>
      </div>
      </div>
</header>

  <div class="highlighted hidden-print">
    <div class="ads leaderboard lb-top">
        <div class="region region-highlighted">
    <section id="block-dfp-lb1" class="block block-dfp clearfix">

      
  <div id="dfp-ad-lb1-wrapper" class="dfp-tag-wrapper"><div  id="dfp-ad-lb1" class="dfp-tag-wrapper">
    
  <script type="text/javascript">
        googletag.cmd.push(function() {
      googletag.display("dfp-ad-lb1");
    });
      </script>
  </div>
</div>
</section>
  </div>
    </div>
  </div>


<div class="main-container container">

  <header role="banner" id="page-header">
    
      </header> <!-- /#page-header -->
  <div class="row">

        <section class="col-sm-12">

            <a id="main-content"></a>

                                                                            <div class="region region-content">
    <section id="block-system-main" class="block block-system clearfix">

      
  

<div itemscope itemtype="http://schema.org/NewsArticle" role="main"  about="/tech/yahoo-secretly-scanned-customer-e-mails-for-us-intelligence-sources" typeof="sioc:Item foaf:Document" class="node node-article view-mode-article_default ">
        <div class="row">
      <div class="col-md-12 ">
        <meta itemscope itemprop="mainEntityOfPage"  itemType="https://schema.org/WebPage" itemid="https://google.com/article"/>
  <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
    <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
      <meta itemprop="url" content="http://www.straitstimes.com/sites/all/themes/custom/bootdemo/images/st-logo.png">
      <meta itemprop="width" content="94">
      <meta itemprop="height" content="94">
    </div>
    <meta itemprop="name" content="The Straits Times">
</div><div class="field field-name-message-info field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even"><div id="msg"></div></div></div></div><header class="node-header"><h1 class="headline node-title" itemprop="headline">Yahoo secretly scanned customer e-mails for US intelligence: Sources</h1></header>      </div>
    </div>
        <div class="row">
      <div class="col-md-8 ">
        <div class="media-group" itemprop="image" itemscope itemtype="http://schema.org/ImageObject" ><div class="media-entity"  rel="" resource="http://players.brightcove.net/4539381505001/default_default/index.html?videoId=5156675453001"><div  class="ds-1col file file-video file-video-brightcove view-mode-image_with_captions clearfix">

  
  <figure class="group-image-frame field-group-html-element"><style type="text/css">
  .sph-media-brightcove-player { width: 100%; height: auto; position: relative; padding-bottom: 66.65%; overflow: hidden; }
  .sph-media-brightcove-player object, .sph-media-brightcove-player video { position: absolute; top: 0; left: 0; width: 100%; height: auto; }
</style>

<div class="sph-media-brightcove-outer-wrapper" id="media-brightcove-1" style="width: ; height: ;">
  <div class="sph-media-brightcove-preview-wrapper" id="sph_media_brightcove_5156675453001_1">

<div style="display: block; position: relative; max-width: 100%;">
  <div style="padding-top: 66.7%;">
    <iframe src="/embed/5156675453001" style="width: 100%; height: 100%; position: absolute; top: 0px; bottom: 0px; right: 0px; left: 0px; border: 0;" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe>
  </div>
</div>


  </div>
</div>
<figcaption class="group-image-caption field-group-html-element"><span class="caption-text">Yahoo secretly scanned all of its customer emails for US intelligence officials, people familiar with case told Reuters. </span></figcaption></figure></div>

</div><div class="media-entity"  rel="" resource="https://static.straitstimes.com.sg/sites/default/files/articles/2016/10/05/yahoo05.jpg"><div  class="ds-1col file file-image file-image-jpeg view-mode-image_with_captions  clearfix">

  
  <figure itemprop="image" class="group-image-frame field-group-html-element"><picture  class="img-responsive">
<!--[if IE 9]><video style="display: none;"><![endif]-->
<source srcset="https://static.straitstimes.com.sg/sites/default/files/styles/x_large/public/articles/2016/10/05/yahoo05.jpg?itok=YnnwFjpW 1x" media="(max-width: 739px)" />
<source srcset="https://static.straitstimes.com.sg/sites/default/files/styles/x_large/public/articles/2016/10/05/yahoo05.jpg?itok=YnnwFjpW 1x" media="(max-width: 1023px)" />
<source srcset="https://static.straitstimes.com.sg/sites/default/files/styles/article_pictrure_780x520_/public/articles/2016/10/05/yahoo05.jpg?itok=NBcCzLEd 1x" media="(min-width: 1200px)" />
<!--[if IE 9]></video><![endif]-->
<img class="img-responsive" srcset="https://static.straitstimes.com.sg/sites/default/files/styles/article_pictrure_780x520_/public/articles/2016/10/05/yahoo05.jpg?itok=NBcCzLEd 780w" alt="It is said that Yahoo scanned hundreds of millions of Yahoo Mail accounts at the behest of the NSA or FBI." title="" />
</picture><meta itemprop="url" content="https://static.straitstimes.com.sg/sites/default/files/articles/2016/10/05/yahoo05.jpg">
<meta itemprop="width" content="800">
<meta itemprop="height" content="600"><figcaption class="group-image-caption field-group-html-element"><span class="caption-text">It is said that Yahoo scanned hundreds of millions of Yahoo Mail accounts at the behest of the NSA or FBI.</span><span class="caption-credit">PHOTO: EPA</span></figcaption></figure></div>

</div></div><div class="group-story-timestamp field-group-html-element"><div class="story-postdate"><div class="label-inline">Published</div>Oct 5, 2016, 5:13 am SGT</div><div class="story-changeddate"><div class="label-inline">Updated</div>Oct 5, 2016, 3:07 pm</div><div class="field field-name-social-media-buttons field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even">
<div class="a2a-buttons a2a_kit a2a_kit_size_32 a2a_default_style" data-a2a-title="Yahoo secretly scanned customer e-mails for US intelligence: Sources">
<a class="a2abtn a2a_button_facebook a2a_counter"></a>
<a class="a2abtn a2a_button_twitter a2a_counter"></a>
<a class="a2abtn a2a_button_whatsapp a2a_counter"></a>
<a class="a2abtn a2a_dd a2a_button_email"></a>
<span role="presentation" class="a2abtn a2abtn-more dropdown">
  <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-expanded="false"><i>More</i></a>
  <div class="dropdown-menu" role="menu">
    <a class="a2abtn a2a_button_facebook"><span>Share</span></a>
    <a class="a2abtn a2a_button_twitter"><span>Tweet</span></a>
    <a class="a2abtn a2a_button_linkedin"><span>Linkedin</span></a>
    <!--<a class="a2abtn a2a_button_email a2a_dd"><span>Email</span></a>-->
    <a class="a2abtn a2a_button_pinterest"><span>Pin</span></a>
    <a class="a2abtn a2a_button_google_plus"><span>Google+</span></a>
    <a class="a2abtn a2a_button_reddit"><span>Reddit</span></a>
    <a class="a2abtn a2a_button_print"><span>Print</span></a>
        <div class="permalink">
        <label for="clip_text">Permalink:</label>
        <textarea id="clip_text" class="form-control" cols=20 rows=1 readonly disabled>http://str.sg/4xou</textarea>
        <button id="clip_button" class="stbtn stbtn-copy">Copy</button>
     </div>
  </div>
</span>
</div>

</div></div></div></div><div class="group-ob-readmore"><div class="field-name-body-linked field field-name-body field-type-text-with-summary field-label-hidden" ><div class="field-items" ><div class="odd field-item" itemprop="articleBody"  property="content:encoded">

<p>SAN FRANCISCO (REUTERS) - Yahoo last year secretly built a custom software program to search all of its customers' incoming e-mails for specific information provided by US intelligence officials, according to people familiar with the matter.</p>
<p>The company complied with a classified US government demand, scanning hundreds of millions of Yahoo Mail accounts at the behest of the National Security Agency (NSA) or Federal Bureau of Investigation (FBI), said three former employees and a fourth person apprised of the events.</p>
<p>Some surveillance experts said this represents the first case to surface of a US Internet company agreeing to a spy agency's request by searching all arriving messages, as opposed to examining stored messages or scanning a small number of accounts in real time.</p>
<div class="ads clearleft"><div id="dfp-ad-imu1-wrapper" class="dfp-tag-wrapper"><div  id="dfp-ad-imu1" class="dfp-tag-wrapper">
    
  <script type="text/javascript">
        googletag.cmd.push(function() {
      googletag.display("dfp-ad-imu1");
    });
      </script>
  </div>
</div></div>
<p>It is not known what information intelligence officials were looking for, only that they wanted Yahoo to search for a set of characters. That could mean a phrase in an e-mail or an attachment, said the sources, who did not want to be identified.</p>
<p>Reuters was unable to determine what data Yahoo may have handed over, if any, and if intelligence officials had approached other e-mail providers besides Yahoo with this kind of request.</p>
<p>According to two of the former employees, Yahoo chief executive Marissa Mayer's decision to obey the directive roiled some senior executives and led to the June 2015 departure of chief information security officer Alex Stamos, who now holds the top security job at Facebook.</p>
<div id="innity-in-post"></div>
<div><div id="dfp-ad-midarticlespecial-wrapper" class="dfp-tag-wrapper"><div  id="dfp-ad-midarticlespecial" class="dfp-tag-wrapper">
    
  <script type="text/javascript">
        googletag.cmd.push(function() {
      googletag.display("dfp-ad-midarticlespecial");
    });
      </script>
  </div>
</div></div>
<p>"Yahoo is a law abiding company, and complies with the laws of the United States," the company said in a brief statement in response to Reuters questions about the demand.</p>
<div class="token-insert-entity-wrapper pull-left mode-embed_related_story" contenteditable="false" embed-code="296138">
<div class="token-insert-entity-preview"> </div>
<div class="token-insert-entity-token">
<div about="/world/united-states/yahoo-says-at-least-500-million-accounts-hacked-in-2014" typeof="sioc:Item foaf:Document" class="ds-1col node node-article view-mode-embed_related_story  clearfix">

  
  <aside class="group-related-story-embed field-group-html5"><div id="file-333096" class="file file-video file-video-brightcove">

        <h2 class="element-invisible"><a href="http://www.straitstimes.com/files/yahoo-to-confirm-big-data-breach-recode">Yahoo to confirm big data breach - Recode</a></h2>
    
  
  <div class="content">
    <img typeof="foaf:Image" class="img-responsive" src="https://static.straitstimes.com.sg/sites/default/files/styles/medium/public/media-brightcove/5137830903001.jpg?itok=atdrLkMR" width="300" height="200" alt="">
</div>

  
</div>
<div class="label-above">Related Story</div>
<h4 class="related-story-headline embed-headline"><a href="http://www.straitstimes.com/world/united-states/yahoo-says-at-least-500-million-accounts-hacked-in-2014">Yahoo says 500 million accounts hacked in 2014 by 'state-sponsored actor', may be largest cyber-breach in history</a></h4></aside>
</div>

</div>
</div>
<p>Yahoo declined any further comment.</p>
<p>Through a Facebook spokesman, Mr Stamos declined a request for an interview.</p>
<p>The NSA referred questions to the Office of the Director of National Intelligence, which declined to comment.</p>
<p>The request to search Yahoo Mail accounts came in the form of a classified edict sent to the company's legal team, according to the three people familiar with the matter.</p>
<p>US phone and Internet companies are known to have handed over bulk customer data to intelligence agencies. But some former government officials and private surveillance experts said they had not previously seen either such a broad demand for real-time Web collection or one that required the creation of a new computer program.</p>
<p>"I've never seen that, a wiretap in real time on a 'selector'," said Mr Albert Gidari, a lawyer who represented phone and Internet companies on surveillance issues for 20 years before moving to Stanford University this year. A selector refers to a type of search term used to zero in on specific information.</p>
<p>"It would be really difficult for a provider to do that," he added.</p>
<p>Experts said it was likely that the NSA or FBI had approached other Internet companies with the same demand, since they evidently did not know what e-mail accounts were being used by the target. The NSA usually makes requests for domestic surveillance through the FBI, so it is hard to know which agency is seeking the information.</p>
<p>Reuters was unable to confirm whether the 2015 demand went to other companies, or if any complied.</p>
<p>Alphabet's Google and Microsoft, two major US e-mail service providers, did not respond to requests for comment.</p>
<h4>CHALLENGING THE NSA</h4>
<p>Under laws including the 2008 amendments to the Foreign Intelligence Surveillance Act, intelligence agencies can ask US phone and Internet companies to provide customer data to aid foreign intelligence-gathering efforts for a variety of reasons, including prevention of terrorist attacks.</p>
<p>Disclosures by former NSA contractor Edward Snowden and others have exposed the extent of electronic surveillance and led the US authorities to modestly scale back some of the programmes, in part to protect privacy rights.</p>
<p>Companies including Yahoo have challenged some classified surveillance before the Foreign Intelligence Surveillance Court, a secret tribunal.</p>
<p>Some FISA experts said Yahoo could have tried to fight last year's demand on at least two grounds: the breadth of the directive and the necessity of writing a special program to search all customers' e-mails in transit.</p>
<p>Apple made a similar argument earlier this year when it refused to create a special program to break into an encrypted iPhone used in the 2015 San Bernardino massacre. The FBI dropped the case after it unlocked the phone with the help of a third party, so no precedent was set.</p>
<p>"It is deeply disappointing that Yahoo declined to challenge this sweeping surveillance order, because customers are counting on technology companies to stand up to novel spying demands in court," Mr Patrick Toomey, an attorney with the American Civil Liberties Union, said in a statement.</p>
<p>Some FISA experts defended Yahoo's decision to comply, saying nothing prohibited the surveillance court from ordering a search for a specific term instead of a specific account.</p>
<p>So-called "upstream" bulk collection from phone carriers based on content was found to be legal, they said, and the same logic could apply to Web companies' mail.</p>
<p>As tech companies become better at encrypting data, they are likely to face more such requests from spy agencies.</p>
<p>Former NSA general counsel Stewart Baker said email providers "have the power to encrypt it all, and with that comes added responsibility to do some of the work that had been done by the intelligence agencies".</p>
<h4>SECRET SIPHONING PROGRAM</h4>
<p>Ms Mayer and other executives ultimately decided to comply with the directive last year rather than fight it, in part because they thought they would lose, said the people familiar with the matter.</p>
<p>Yahoo in 2007 had fought a FISA demand that it conduct searches on specific e-mail accounts without a court-approved warrant. Details of the case remain sealed, but a partially redacted published opinion showed Yahoo's challenge was unsuccessful.</p>
<p>Some Yahoo employees were upset about the decision not to contest the more recent edict and thought the company could have prevailed, the sources said.</p>
<p>They were also upset that Ms Mayer and Yahoo general counsel Ron Bell did not involve the company's security team in the process, instead asking Yahoo's e-mail engineers to write a program to siphon off messages containing the character string the spies sought and store them for remote retrieval, according to the sources.</p>
<p>The sources said the program was discovered by Yahoo's security team in May 2015, within weeks of its installation. The security team initially thought hackers had broken in.</p>
<p>When Mr Stamos found out that Ms Mayer had authorised the program, he resigned as chief information security officer and told his subordinates that he had been left out of a decision that hurt users' security, the sources said. Due to a programming flaw, he told them hackers could have accessed the stored e-mails.</p>
<p><a href="http://bit.ly/2dL003k">Mr Stamos's announcement in June 2015 that he had joined Facebook</a> did not mention any problems with Yahoo. </p>
<p>In a separate incident, Yahoo last month said "state-sponsored" hackers had gained access to 500 million customer accounts in 2014. The revelations have brought new scrutiny to Yahoo's security practices as the company tries to complete a deal to sell its core business to Verizon Communications for US$4.8 billion (S$6.58 billion).</p>

</div></div></div><div class="field field-name-print-citation field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even"><div class=" hidden-print">
</div></div></div></div><div class="story-keywords hidden-print "><div class="label-inline">Topics:&nbsp;</div><ul><li itemprop="keywords"><a href="/tags/yahoo" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">YAHOO</a></li><li itemprop="keywords"><a href="/tags/privacy-issues" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">PRIVACY ISSUES</a></li><li itemprop="keywords"><a href="/tags/surveillance" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">SURVEILLANCE</a></li></ul></div><div class="field field-name-social-media-buttons-bottom field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even">
<div class="a2a-buttons a2a_kit a2a_kit_size_32 a2a_default_style clearfix" data-a2a-title="Yahoo secretly scanned customer e-mails for US intelligence: Sources">
<a class="a2abtn a2a_button_facebook a2a_counter"></a>
<a class="a2abtn a2a_button_twitter a2a_counter"></a>
<a class="a2abtn a2a_button_whatsapp a2a_counter"></a>
<a class="a2abtn a2a_dd a2a_button_email"></a>
<span role="presentation" class="a2abtn a2abtn-more dropdown">
  <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-expanded="false"><i>More</i></a>
  <div class="dropdown-menu" role="menu">
    <a class="a2abtn a2a_button_facebook"><span>Share</span></a>
    <a class="a2abtn a2a_button_twitter"><span>Tweet</span></a>
    <a class="a2abtn a2a_button_linkedin"><span>Linkedin</span></a>
    <!--<a class="a2abtn a2a_button_email a2a_dd"><span>Email</span></a>-->
    <a class="a2abtn a2a_button_pinterest"><span>Pin</span></a>
    <a class="a2abtn a2a_button_google_plus"><span>Google+</span></a>
    <a class="a2abtn a2a_button_reddit"><span>Reddit</span></a>
    <a class="a2abtn a2a_button_print"><span>Print</span></a>
    <div class="permalink">
        <label for="clip_text">Permalink:</label>
        <textarea id="clip_text" class="form-control" cols=20 rows=1 readonly disabled>http://str.sg/4xou</textarea>
        <button id="clip_button" class="stbtn stbtn-copy">Copy</button>
     </div>
  </div>
</span>
</div>

</div></div></div><div class=" hidden-print"><div class="sibling-story-links"><div id="prev-next-story" class="hidden-print"></div></div></div></div><div class="field field-name-outbrain-content-recommendation field-type-ds field-label-hidden hidden-print"><div class="field-items"><div class="field-item even"><div class="OUTBRAIN" data-src="http://www.straitstimes.com/tech/yahoo-secretly-scanned-customer-e-mails-for-us-intelligence-sources" data-widget-id="AR_4" data-ob-template="StraitsTimes" ></div> 
<script type="text/javascript" async="async" src="https://widgets.outbrain.com/outbrain.js"></script></div></div></div><div class="field field-name-publish-time-for-google field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even"><time itemprop="datePublished" datetime="2016-10-05T05:13:21+08:00" data-timestamp="1475615601" ></time><time itemprop="dateModified" datetime="2016-10-05T15:07:33+08:00" data-timestamp="1475651253" ></time></div></div></div>      </div>
      <div class="col-md-4  article-sidebar hidden-print">
        <div class="ads sidebar-ads"><div id="dfp-ad-imu2-wrapper" class="dfp-tag-wrapper"><div  id="dfp-ad-imu2" class="dfp-tag-wrapper">
    
  <script type="text/javascript">
        googletag.cmd.push(function() {
      googletag.display("dfp-ad-imu2");
    });
      </script>
  </div>
</div></div><div class="sidebar-list sbl-blue"><section id="block-block-10" class="block block-block clearfix">

      
  <div class="OUTBRAIN" data-src="http://www.straitstimes.com/tech/yahoo-secretly-scanned-customer-e-mails-for-us-intelligence-sources" data-widget-id="SB_4" data-ob-template="StraitsTimes" ></div> 
<script type="text/javascript" async="async" src="https://widgets.outbrain.com/outbrain.js"></script>
<style>
.SB_4.ob-strip-layout .ob-widget-header { margin-top: 45px; }
</style>
</section>
</div><div class="group-brandinsider field-group-html-element sidebar-list sbl-gray"><h2><span>BrandInsider</span></h2><div class="required-fields view-content"><div class="field field-name-dfp-bi1 field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even"><section id="block-dfp-bi1" class="block block-dfp clearfix">

      
  <div id="dfp-ad-bi1-wrapper" class="dfp-tag-wrapper"><div  id="dfp-ad-bi1" class="dfp-tag-wrapper">
    
  <script type="text/javascript">
        googletag.cmd.push(function() {
      googletag.display("dfp-ad-bi1");
    });
      </script>
  </div>
</div>
</section>
</div></div></div><div class="field field-name-dfp-bi2 field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even"><section id="block-dfp-bi2" class="block block-dfp clearfix">

      
  <div id="dfp-ad-bi2-wrapper" class="dfp-tag-wrapper"><div  id="dfp-ad-bi2" class="dfp-tag-wrapper">
    
  <script type="text/javascript">
        googletag.cmd.push(function() {
      googletag.display("dfp-ad-bi2");
    });
      </script>
  </div>
</div>
</section>
</div></div></div><div class="field field-name-dfp-bi3 field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even"><section id="block-dfp-bi3" class="block block-dfp clearfix">

      
  <div id="dfp-ad-bi3-wrapper" class="dfp-tag-wrapper"><div  id="dfp-ad-bi3" class="dfp-tag-wrapper">
    
  <script type="text/javascript">
        googletag.cmd.push(function() {
      googletag.display("dfp-ad-bi3");
    });
      </script>
  </div>
</div>
</section>
</div></div></div><div class="field field-name-dfp-bi4 field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even"><section id="block-dfp-bi4" class="block block-dfp clearfix">

      
  <div id="dfp-ad-bi4-wrapper" class="dfp-tag-wrapper"><div  id="dfp-ad-bi4" class="dfp-tag-wrapper">
    
  <script type="text/javascript">
        googletag.cmd.push(function() {
      googletag.display("dfp-ad-bi4");
    });
      </script>
  </div>
</div>
</section>
</div></div></div></div></div><div class="sidebar-list sbl-lt-blue"><section id="block-views-79a04c4edb3b08d123224ebb4ef6097d" class="block block-views clearfix">

        <h2 class="block-title">Sponsored Content</h2>
    
  <div class="view view-advertorials view-id-advertorials view-display-id-article_sponsored_content view-dom-id-74a6a6f2ca1ac043db63eeff5f14cd49">
        
  
  
      <div class="view-content" >
        <div class="views-row views-row-1 views-row-odd views-row-first" >
      
          <div class="pull-left"><a href="javascript:void(0)" onclick="window.open('http://pubads.g.doubleclick.net/gampad/clk?id=4422742753&amp;iu=/5908/project')"><div id="file-515474" class="file file-image file-image-jpeg">

        <h2 class="element-invisible"><a href="/files/posb1300x200jpg-1">posb1_300x200.jpg</a></h2>
    
  
  <div class="content">
    <img typeof="foaf:Image" class="img-responsive" src="https://static.straitstimes.com.sg/sites/default/files/styles/medium/public/advertorials/2017/10/27/posb1_300x200_1.jpg?itok=lew6aAAF" width="300" height="200" alt="" />  </div>

  
</div>
</a></div>    
  <div class="views-field views-field-title">        <span class="field-content"><a href="javascript:void(0)" onclick="window.open('http://pubads.g.doubleclick.net/gampad/clk?id=4422742753&amp;iu=/5908/project')">Expecting mum on a budget: How to build a cosy baby nursery</a></span>  </div>  
  <div class="views-field views-field-field-impression-tracking-image-">        <div class="field-content"></div>  </div>  </div>
  <div class="views-row views-row-2 views-row-even" >
      
          <div class="pull-left"><a href="http://www.straitstimes.com/branded-content/rejuvenate-yourself-at-shangri-la-hotel-singapores-new-tower-wing"><div id="file-441920" class="file file-image file-image-jpeg">

        <h2 class="element-invisible"><a href="/files/shangri-la2017may27354x235smalljpg">shangri-la_2017may27_354x235_small.jpg</a></h2>
    
  
  <div class="content">
    <img typeof="foaf:Image" class="img-responsive" src="https://static.straitstimes.com.sg/sites/default/files/styles/medium/public/advertorials/2017/05/25/shangri-la_2017may27_354x235_small.jpg?itok=vdENQ3Qr" width="300" height="200" alt="" />  </div>

  
</div>
</a></div>    
  <div class="views-field views-field-title">        <span class="field-content"><a href="http://www.straitstimes.com/branded-content/rejuvenate-yourself-at-shangri-la-hotel-singapores-new-tower-wing">Rejuvenate yourself at Shangri-La Hotel, Singapore’s new Tower Wing</a></span>  </div>  
  <div class="views-field views-field-field-impression-tracking-image-">        <div class="field-content"></div>  </div>  </div>
  <div class="views-row views-row-3 views-row-odd views-row-last" >
      
          <div class="pull-left"><a href="javascript:void(0)" onclick="window.open('http://pubads.g.doubleclick.net/gampad/clk?id=4451571341&amp;iu=/5908/project')"><div id="file-510656" class="file file-image file-image-jpeg">

        <h2 class="element-invisible"><a href="/files/300x200-mbsjpg-1">300x200-mbs.jpg</a></h2>
    
  
  <div class="content">
    <img typeof="foaf:Image" class="img-responsive" src="https://static.straitstimes.com.sg/sites/default/files/styles/medium/public/advertorials/2017/10/17/300x200-mbs_1.jpg?itok=cxzWmOwZ" width="300" height="200" alt="" />  </div>

  
</div>
</a></div>    
  <div class="views-field views-field-title">        <span class="field-content"><a href="javascript:void(0)" onclick="window.open('http://pubads.g.doubleclick.net/gampad/clk?id=4451571341&amp;iu=/5908/project')">Don’t miss these delicious deals at The Shoppes at Marina Bay Sands</a></span>  </div>  
  <div class="views-field views-field-field-impression-tracking-image-">        <div class="field-content"><img src="https://pubads.g.doubleclick.net/gampad/adx?iu=/5908/project&d_imp=1&d_imp_hdr=1&t=link%3D20171018stwebspecialros3&sz=1x1&c=3453453" class="hidden" width="0" height="0" /></div>  </div>  </div>
    </div>
  
  
  
  
  
  
</div>
</section>
</div><div class="field field-name-st-native-ads-troubleshooting field-type-ds field-label-hidden"><div class="field-items"><div class="field-item even"><p><img alt="" class="hidden" height="0" src="http://pubads.g.doubleclick.net/gampad/ad?iu=/5908/project&amp;link%3D20160919strosnative03pjo&amp;sz=1x1&amp;c=12345" width="0" /> <img alt="" class="hidden" height="0" src="http://pubads.g.doubleclick.net/gampad/ad?iu=/5908/project&amp;link%3D20160919strosnative03pj&amp;sz=1x1&amp;c=12345" width="0" /> <img alt="" class="hidden" height="0" src="http://pubads.g.doubleclick.net/gampad/ad?iu=/5908/project&amp;t=link%3D20160919strosnative03pjo3&amp;sz=1x1&amp;c=12345 " width="0" /></p></div></div></div>      </div>
    </div>
    </div>


<!-- Needed to activate display suite support on forms -->

</section>
  </div>
    </section>

    
  </div>
</div>
<footer class="footer container">

  <div class="footer-banner-wrapper hidden-print">
    <div class="footer-banner-block">
<section id="block-block-6" class="block block-block clearfix">

      
  <div class="footer-subscribe-block">
    <h4>Subscribe to <span>The Straits Times</span></h4>
    <div class="footer-subscribe-block--call"> 
        call <span class="tel" style="font-size:24px;">6388-3838</span> or <a href="http://www.sphsubscription.com.sg/eshop/?r=products/newsubscriptionpackages&pcode=ST&utm_medium=online&utm_source=homepagefooter&utm_campaign=stproductpage&utm_term=tactical" target="_blank">click here</a>
     </div>
</div>

<div class="footer-apps-block">
    <div class="footer-apps-block--ios">
        <div class="footer-apps-block--ios-text"><a href="https://itunes.apple.com/sg/app/the-straits-times-for-iphone/id547465441?mt=8" target="_blank">Available for<br /> iPhones and iPads</a></div>
    </div>
    <div class="footer-apps-block--android">
        <div class="footer-apps-block--android-text"><a href="https://play.google.com/store/apps/details?id=com.buuuk.st&hl=en" target="_blank">Available in<br /> Google Play</a></div>
    </div>
</div>
</section>
    </div>
  </div>
  <div class="back-to-top hidden-print">
    <a href="#main-content" class="hidden-xs">Back to the top</a>
    <a href="#main-content" class="visible-xs"><img src="/sites/all/themes/custom/bootdemo/images/arrow-up.svg"/></a>
  </div>
  <div class="wrapper row">
    <div class="col-lg-12">
  <div class="footer-menu hidden-print"><div class="row"><ul class="col-lg-2 col-md-2 col-sm-2 col-xs-6 list-group list-footer"><li class="item-874 list-group-item"><a href="/singapore">Singapore</a></li><li class="item-19765 list-group-item"><a href="/politics">Politics</a></li><li class="item-19759 list-group-item"><a href="/asia">Asia</a></li></ul><ul class="col-lg-2 col-md-2 col-sm-2 col-xs-6 list-group list-footer"><li class="item-873 list-group-item"><a href="/world">World</a></li><li class="item-19776 list-group-item"><a href="/videos">Videos</a></li><li class="item-19774 list-group-item"><a href="/multimedia">Multimedia</a></li></ul><ul class="col-lg-2 col-md-2 col-sm-2 col-xs-6 list-group list-footer"><li class="item-877 list-group-item"><a href="/lifestyle">Lifestyle</a></li><li class="item-19767 list-group-item"><a href="/lifestyle/food">Food</a></li><li class="item-19778 list-group-item"><a href="/forum">Forum</a></li></ul><ul class="col-lg-2 col-md-2 col-sm-2 col-xs-6 list-group list-footer"><li class="item-875 list-group-item"><a href="/opinion">Opinion</a></li><li class="item-19741 list-group-item"><a href="/business">Business</a></li><li class="item-878 list-group-item"><a href="/sport">Sport</a></li></ul><ul class="col-lg-2 col-md-2 col-sm-2 col-xs-6 list-group list-footer"><li class="item-19782 list-group-item"><a href="/tech">Tech</a></li></ul></div></div>
    <div class="region region-footer">
    <section id="block-block-4" class="block block-block follow-st hidden-print clearfix">

        <h2 class="block-title">Follow ST</h2>
    
  <ul class="social-buttons list-inline">
  <li class="btn btn-twitter"><a href="http://twitter.com/stcom"  target="_blank" class="fa fa-twitter"></a></li>
  <li class="btn btn-facebook"><a href="http://www.facebook.com/TheStraitsTimes" target="_blank" class="fa fa-facebook"></a></li>
  <li class="btn btn-pinterest"><a href="http://www.pinterest.com/thestraitstimes" target="_blank" class="fa fa-pinterest"></a></li>
  <li class="btn btn-instagram"><a href="http://instagram.com/straits_times" target="_blank" class="fa fa-instagram"></a></li>
  <li class="btn btn-rss"><a href="/RSS-Feeds" target="_blank" class="fa fa-rss"></a></li>
</ul>
</section>
<section id="block-block-2" class="block block-block site-title clearfix">

        <h2 class="block-title">The Straits Times</h2>
    
  <p class="copy">SPH Digital News / Copyright © 2017 Singapore Press Holdings Ltd. Co. Regn. No. 198402868E. <br> All rights reserved | <a href="http://sph.com.sg/legal/website_tnc.html" target="_blank">Terms &amp; Conditions</a>&nbsp;| <a href="http://sph.com.sg/legal/pdpa.html" target="_blank">Data Protection Policy</a>&nbsp;| <a href="//www.straitstimes.com/advertise-with-the-straits-times" target="_blank">Advertise with us</a></p>

</section>
<section id="block-dfp-articlespecial" class="block block-dfp clearfix">

      
  
</section>
  </div>
    </div>
  </div>
</footer><!-- Modal -->
<div class="modal fade" id="ldapAlert" tabindex="-1" role="dialog" aria-labelledby="ldapAlertLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <p>We have been experiencing some problems with subscriber log-ins and apologise for the inconvenience caused. Until we resolve the issues, subscribers need not log in to access ST Digital articles. But a log-in is still required for our PDFs.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<style>
.modal-backdrop{
  z-index: 10000000;
}
.modal {
  z-index: 10000001;
  font-family: Curator;
  font-size: 16px;
}
</style>
  <script src="https://static.straitstimes.com.sg/sites/default/files/js/js_bK_LwYueczIHJRRBhtEMWajaWnrtOXF2pjKpHJSHBCg.js"></script>
<script>
<!-- setting the related box height as the same-->
          (function($) {
          $(document).ready(function() {
           var cw = $('.mode-embed_horizontal_related_story_q .field-items').height();
           $('.mode-embed_horizontal_related_story_q .field-item').css({
              'height': + cw + 'px'
           });
          });
            })(jQuery);
          </script>
<script>
       (function ($) {

        ZeroClipboard.config( { moviePath: "/sites/all/themes/custom/bootdemo/js/ZeroClipboard.swf" } );

          var client = new ZeroClipboard( $(".permalink .stbtn-copy") );

          client.on( "load", function(client) {

            client.on( "datarequested", function(client) {
              var text = $("#clip_text").text();
              client.setText(text);
            });

            // callback triggered on successful copying
            client.on( "complete", function(client, args) {
              //console.log("Text copied to clipboard: \n" + args.text );
            });
          });

          // In case of error - such as Flash not being available
          client.on( "wrongflash noflash", function() {
            ZeroClipboard.destroy();
          } );

      }(jQuery));

      </script>
<script>
       (function ($) {

        ZeroClipboard.config( { moviePath: "/sites/all/themes/custom/bootdemo/js/ZeroClipboard.swf" } );

          var client = new ZeroClipboard( $(".permalink .stbtn-copy") );

          client.on( "load", function(client) {

            client.on( "datarequested", function(client) {
              var text = $("#clip_text").text();
              client.setText(text);
            });

            // callback triggered on successful copying
            client.on( "complete", function(client, args) {
              //console.log("Text copied to clipboard: \n" + args.text );
            });
          });

          // In case of error - such as Flash not being available
          client.on( "wrongflash noflash", function() {
            ZeroClipboard.destroy();
          } );

      }(jQuery));

      </script>
    <script>
    (function($) {
      window.paywallSdkCallbackHandler = paywallSdkCallbackHandler;
      var quotaValue;
      function getQuotaValue(){
        return quotaValue;
      }
      function htmlEncode(value){
        //create a in-memory div, set it's inner text(which jQuery automatically encodes)
        //then grab the encoded contents back out.  The div never exists on the page.
        return $('<div/>').text(value).html();
      }
      function paywallSdkCallbackHandler(loginError, err, quota) {
      quotaValue = quota;

      var userSession = PaywallSdk.userSession();

      ////////////////////////////////////////////////////////////////////////////////////////
      // stubs for different user type flows
      // for free or not metered article/pages
      // do NOT show the paywall if article is free or not metered
      if (quota.articleInfo.isFree ||
                quota.articleInfo.paid === 0) {
            switch (userSession.userType) {
                case 'subscribed':
                    // show the article
                    break;
                case 'registered':
                    if (quota.usage.quotaExceeded) {
                    }
                    else {
                    }
                    break;
                case 'anonymous_without_quota':
                    // is an anonymous user who is inside a geofence and do NOT have quota due to the geolocation entitlement
                    break;
                case 'registered_without_quota':
                    // is a registered user who is inside a geofence and do NOT have quota due to the geolocation entitlement
                    break;
                default: // defaults to 'anonymous'
                    if (quota.usage.quotaExceeded) {
                    }
                    else {
                    }
                    break;
            }
        }
        // else this article is metered
        else {
            switch (userSession.userType) {
                case 'subscribed':
                    // show the article
                    break;
                // is an anonymous user who is inside a geofence and do NOT have quota due to the geolocation entitlement
                case 'anonymous_without_quota':
                    // show the article
                    break;
                // is a registered user who is inside a geofence and do NOT have quota due to the geolocation entitlement
                case 'registered_without_quota':
                    // show the article
                    break;

                // show the paywall for registered and anonymous users
                case 'registered':
                default: // defaults to 'anonymous'
                    if (quota.usage.quotaExceeded && loginError == null) {

                        var $hardPaywallModal = $('#hardPaywallModal');

                        if ($hardPaywallModal && $hardPaywallModal.modal) {
                            $hardPaywallModal.modal();
                        }
                    }
                    else if (quota.message && loginError == null) {
                        $('.paywall-fixed-popup').removeClass('hidden');
                    }

                    if ((quota.usage.quotaExceeded || quota.message) && loginError == null) {
                        var popup_ati_tag = '';
                        if(userSession.userType=='anonymous'){
                          popup_ati_tag= '<img width="1" height="1" alt="" src="http://logw348.ati-host.net/hit.xiti?s=538340&s2=12&p=Paywall_level_1&x1=Paywall_level_1&x6=1&x10='+encodeURIComponent(userSession.deviceId)+'&di=&at=&ac=" >';
                        }else if(userSession.userType=='registered'){
                          popup_ati_tag= '<img width="1" height="1" alt="" src="http://logw348.ati-host.net/hit.xiti?s=538340&s2=12&p=Paywall_level_2&x1=Paywall_level_2&x6=2&x10='+encodeURIComponent(userSession.deviceId)+'&at='+encodeURIComponent(userSession.companyVisitorId)+'&di=&ac=" >';
                        }
                        $('.paywall-message-text').html(quota.message+popup_ati_tag);
                        var secondMsg = quota.secondaryMessage;
                        $('.paywall-secondaryMessage-text').html(secondMsg);
                        $('.paywall-login-link').on('click', function(e) {
                            e.preventDefault();

                            PaywallSdk.login();
                        });

                        $('.paywall-subscribe-link').on('click', function(e){
                            e.preventDefault();

                            PaywallSdk.subscribe();
                        });

                        $('.paywall-register-link').on('click', function(e){
                            e.preventDefault();

                            PaywallSdk.register();
                        });

                        $('.paywall-close-button').on('click', function(e) {
                            e.preventDefault();

                            $('.paywall-fixed-popup').addClass('hidden');
                        });
                        content_body=document.getElementsByClassName("field-name-body");  // Find the element
                        if(content_body[0]) content_body[0].innerHTML="";
                        content_post_date=document.getElementsByClassName("group-story-timestamp");
                        if(content_post_date[0])content_post_date[0].innerHTML="";
                        content_media=document.getElementsByClassName("media-entity");
                        if(content_media[0])content_media[0].innerHTML="";

                    }
                    break;
            }
        }

      // Login & Logout :)
      if ((userSession.userType != 'anonymous') && (userSession.userType != 'anonymous_without_quota')) {
        var st_login_info = '<li class="nav-user"><a href="https://acc-reg.sphdigital.com/RegAuth2/sphChangePassword.html?svc=stp" name="login-user-name">'+htmlEncode(userSession.username)+'</a></li>'+
        '<li class="nav-logout"><a href="#">Logout</a></li>';
        $('.menu-user').html(st_login_info);
      } else {
        var st_login_info = '<li class="nav-login"><a href="#">Login</a></li>'+
        '<li class="nav-subscribe"><a href="http://www.sphsubscription.com.sg/eshop/?r=products/newsubscriptionpackages&pcode=ST&utm_medium=online&utm_source=homepageheader&utm_campaign=stproductpage&utm_term=tactical" target="_blank">Subscribe</a></li>';
        $('.menu-user').html(st_login_info);
      }

      // Login
      $('.menu-user .nav-login a').on('click', function (e) {
        e.preventDefault();
        PaywallSdk.login();
      });
      $('.popup-login').on('click', function (e) {
        e.preventDefault();
        PaywallSdk.login();
      });

      // Logout
      $('.menu-user .nav-logout a').on('click', function (e) {
        e.preventDefault();
        PaywallSdk.logout();
      });

      }
    })(jQuery);
  </script>


    <script src="//straitstimes-mobilegateway-api-SIN-LIVE.stapi.straitstimes.com/scripts/paywall-sdk/dist/paywallSdk.min.js?2017102717"
      data-name="paywallSdk"
            data-apiBaseUrl="https://straitstimes-mobilegateway-api-SIN-LIVE.stapi.straitstimes.com"
      data-oauthBaseUrl="https://acc-auth.sphdigital.com/amserver/oauth2"
      data-loginBaseUrl="https://acc-reg.sphdigital.com/RegAuth2"
      data-logoutUrl="https://acc-auth.sphdigital.com/amserver/UI/Logout"
            data-publication="ST"
      data-subdomain=""
      data-articleId="stcom-299800"
      data-isMetered="true"
      data-callback="paywallSdkCallbackHandler">
    </script>
      
<!-- mainWrapper end --> 
</div><!-- mainWrapper end -->
<img src="//amplifypixel.outbrain.com/pixel?mid=00529a8e9e01c3bfad3c4bd7ec1ab148f6" style="display:none;">
</body>

<!-- Start TMS and Smart tagging -->
<script  type="text/javascript">
  //var tag;
    (function($) {
      //For smart taging
      //tag = new ATInternet.Tracker.Tag();
      var ac = '';
      var ldapw = "";
      var visitorcat = 1;
      if(typeof PaywallSdk=='object'){
        var paywallUserSession = PaywallSdk.userSession();
        //console.log(paywallUserSession);
        if (paywallUserSession) {
          if(paywallUserSession.companyVisitorId)
            ldapw = paywallUserSession.companyVisitorId;

          if(ldapw){
            var meta = document.createElement('meta');
            meta.name = 'ldapw';
            meta.content = ldapw;
            document.getElementsByTagName('head')[0].appendChild(meta);
          }
          if(paywallUserSession.userType=='anonymous'){
            visitorcat = 1;
          }else if(paywallUserSession.userType=='registered'){
            visitorcat = 3;
          }else if(paywallUserSession.userType=='anonymous_without_quota'){
            visitorcat = 4;
          }else{
            visitorcat = 2;
          }
        }

      } else {
        //console.log("Paywall object not loaded");
      }

      if(ldapw != "")
          ac = "2";


      //Updating data variable
      _data.at = encodeURIComponent(ldapw);
      _data.ac =  ac;
      _data.visitorcat = visitorcat;
      _data.deviceid = encodeURIComponent(paywallUserSession.deviceId);

     //  var tag_page_vars = {
     //                      level2:_data.level2,
     //                      name: _data.title
     //                      };
     //  if(_data.chapter1 != "")
     //    tag_page_vars.chapter1 = _data.chapter1;
     //  if(_data.chapter2 != "")
     //    tag_page_vars.chapter2 = _data.chapter2;

     //  tag.page.set(tag_page_vars);

     // tag.customVars.set({
     //    site: {
     //      1: _data.title,
     //      2: encodeURIComponent(document.location.href),
     //      3: _data.contenttype, //content type, 1->article, 2->photo, 3->video
     //      4: _data.pagination,  //pagination
     //      5: _data.author,  //author
     //      6: _data.visitorcat,  //visitor category, 1->free, 2->premium
     //      7: _data.contentcat,  //content category, 1->free, 2->premium
     //      8: _data.lotameid,  //lotame id
     //      9: _data.articleid,
     //      10: _data.articlecount,
     //      11: _data.printcat,
     //      12: _data.keyword,
     //      13: _data.adblocker,
     //      14: _data.pubdate
     //    }
     //  });

     //  //visitor login id
     //  tag.identifiedVisitor.set ({
     //      id: _data.at,
     //      category: _data.ac
     //  });


     //  tag.dispatch();
     })(jQuery);

     // function virtualPV(element) {
     //  //console.log("VirtualPV called");
     //  //console.log(element);
     //    return tag.page.send({
     //      elem: element,
     //      level2: _data.level2,
     //      name: _data.title,  //same value as site custom variable 1 or x1
     //      chapter1: _data.chapter1,   //comment out if no values for chapter1, chapter2, chapter3
     //      chapter2: _data.chapter2,
     //      customVars: {
     //        site: {
     //          1: _data.title,
     //          2: encodeURIComponent(document.location.href),
     //          3: 2, //content type, 1->article, 2->photo, 3->video
     //          4: _data.pagination,  //pagination
     //          5: _data.author,  //author
     //          6: _data.visitorcat,  //visitor category, 1->free, 2->premium
     //          7: _data.contentcat,  //content category, 1->free, 2->premium
     //          8: _data.lotameid,  //lotame id
     //          9: _data.articleid,
     //          10: _data.articlecount,
     //          11: _data.printcat,
     //          12: _data.keyword,
     //          13: _data.adblocker,
     //          14: _data.pubdate
     //        }
     //      }
     //    });
     //  }

  </script>
<!-- End TMS Tagging -->

<!-- Begin comScore Tag -->
<script>
document.write(unescape("%3Cscript src='" + (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js' %3E%3C/script%3E"));
</script>
<script>
COMSCORE.beacon({c1:2,c2:6288331,c3:"",c4:"",c5:"",c6:"",c15:""});
</script>
<noscript>
<img src="http://b.scorecardresearch.com/p?c1=2&c2=6288331&c3=&c4=&c5=&c6=&c15=&cj=1" />
</noscript>
<!-- End comScore Tag -->

<!-- START: paywall css -->
  <link rel="stylesheet" href="//straitstimes-mobilegateway-api-SIN-LIVE.stapi.straitstimes.com/scripts/paywall-sdk/st/css/paywall-popup.css?2017102717">
  <!--[if gte IE 9]>
  <style type="text/css">
      .paywall-gradient {
          filter: none;
      }
  </style>
  <![endif]-->
<!-- END: paywall css -->

<!-- Start Querly Tag -->
<script type="text/javascript" src="http://www.queryly.com/js/queryly.v2.js" defer></script>
<script type="text/javascript" src="http://www.queryly.com/js/straitstimes-advanced-search.js" defer></script>
<script type="text/javascript">
var js_sph_base_url = "http://www.straitstimes.com";
</script>
<script type="text/javascript" src="/sites/all/themes/custom/bootdemo/js/querylyiniter.js" defer></script>
<!-- End Querly Tag -->
<script type="text/javascript">
(function($) {
var pathArray = window.location.pathname.split( '/' );
var secondLevelLocation = pathArray[2];
if((pathArray[1]=='newsletter') && (pathArray[2]=='regform') ){
    $("script[src='http://www.googletagservices.com/tag/js/gpt.js']").remove();
    $("script[src='http://partner.googleadservices.com/gpt/pubads_impl_94.js']").remove();
}
})(jQuery);
</script>
<script type="text/javascript">
(function($) {
if($('#food-search').length >= 1){
$('#food-search').keypress(function(e) {
    if (e.which === 13) {
        if ($('#food-search').value != "") {
          var food = $('#food-search').val();
            window.location = "http://www.straitstimes.com/search?searchkey="+ food + "&groups=/lifestyle/food/";
        }
        }
    });
  }
 })(jQuery);
</script>
</html>
